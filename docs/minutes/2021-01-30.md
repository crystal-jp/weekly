# Weekly Crystal-JP #26 (2021/01/30開催)

## 会場

- Issue (開催準備用): <https://github.com/crystal-jp/weekly/issues/44>
- HackMD: <https://hackmd.io/@makenowjust/ByMGoqGg_>
- Meet: <https://meet.google.com/kpr-uvwo-wce>

## 参加者

- [@MakeNowJust][] (主催)
- [@tobyapi][]

[@MakeNowJust]: https://github.com/MakeNowJust
[@tobyapi]: https://github.com/tobyapi

## 話題

### Crystal 0.36.0がリリースされました

1/26に Crystal のバージョン0.36.0がリリースされました。

リリース記事は次のURLになります。
(日本語訳は現在、準備中です)

<https://crystal-lang.org/2021/01/26/crystal-0.36.0-released.html>

全体的に 1.0 に向けての準備を進めている印象を受けます。

今回はこれらの変更を見ていきたいと思います。

#### `lib` の中での `type` が `alias` に

`lib` の中では `type` キーワードを使って型エイリアスを指定していました。
しかし、これは一貫性がないということで、今回のリリースで `alias` を使うものに統一されたようです。

```diff
lib YourLib
-  type ACallback = Int32 -> Int32
+ alias ACallback = Int32 -> Int32
end
```

妥当な修正な気がしますが今更感があります。
そこそこの大きさの破壊的変更な気がするので、C 言語とのバインディングライブラリを書いている方は注意してください。

#### `**` 演算子が右結合に

これまでは冪乗を表す `**` 演算子は左結合だったのですが、他の言語や Ruby と合わせて右結合に修正されました。
つまり、 `2 ** 3 ** 4` が `(2 ** 3) ** 4` ではなく `2 ** (3 ** 4)` と解釈されるということです。

なお、Ruby では `-2 ** 2` は `-(2 ** 2)` と解釈され `-4` になりますが、Crystal では `(-2) ** 2` と解釈され `-4` となるようです。
これは Ruby では演算子の優先順位が単項演算子よりも `**` の方が高いために起こるようですが、あまり直観的ではないように思います。

## 気になる Pull Request

### 安定ソートの実装 ([#10163](https://github.com/crystal-lang/crystal/pull/10163))

安定ソートの実装として Rust の標準ライブラリに実装されているものをポートしたものを追加する Pull Request が出されています。
この実装は、Tim ソートからギャロッピングを除いたようなもので、そこそこ高速に動作するようです。

Crystal の現在のソートの実装はイントロソートなのですが、この PR でソートアルゴリズムの選択肢が広まると便利そうです。

## あとがき

約1ヶ月ぶりの開催になります。
そろそろ Weekly というのはやめた方がよいのではないだろうか。
